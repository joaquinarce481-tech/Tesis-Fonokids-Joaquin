<div class="login-wrapper">
  <!-- Elementos flotantes decorativos -->
  <div class="floating-elements">
    <div class="star"></div>
    <div class="star"></div>
    <div class="star"></div>
    <div class="heart"></div>
    <div class="heart"></div>
    <div class="cloud"></div>
    <div class="cloud"></div>
  </div>
  
  <!-- Título de bienvenida -->
  <h1 class="titulo-bienvenida">NUEVA CONTRASEÑA</h1>
  
  <div class="login-box">
    <!-- Mascota -->
    <div class="mascot">🔐</div>
    
    <p class="subtitle">
      ¡Perfecto! Tu código fue verificado. <br>
      Ahora crea tu nueva contraseña segura.
    </p>
    
    <!-- Formulario -->
    <form (ngSubmit)="cambiarContrasena()" #resetForm="ngForm">
      
      <div class="input-group">
        <input 
          type="password"
          placeholder="Nueva contraseña"
          [(ngModel)]="newPassword"
          name="newPassword"
          required
          minlength="6"
          [disabled]="isLoading"
          (input)="onPasswordChange()"
        />
        <div class="input-icon">🔒</div>
      </div>
      
      <div class="input-group">
        <input 
          type="password"
          placeholder="Confirmar contraseña"
          [(ngModel)]="confirmPassword"
          name="confirmPassword"
          required
          minlength="6"
          [disabled]="isLoading"
          (input)="onPasswordChange()"
        />
        <div class="input-icon">✅</div>
      </div>
      
      <!-- Indicador de fortaleza de contraseña -->
      <div class="password-strength" *ngIf="newPassword.length > 0">
        <div class="strength-label">Fortaleza de contraseña:</div>
        <div class="strength-bar">
          <div 
            class="strength-fill" 
            [ngClass]="getStrengthClass()"
            [style.width.%]="getStrengthPercentage()">
          </div>
        </div>
        <div class="strength-text" [ngClass]="getStrengthClass()">
          {{ getStrengthText() }}
        </div>
      </div>
      
      <!-- Validaciones de contraseña -->
      <div class="password-rules" *ngIf="newPassword.length > 0">
        <div class="rule" [ngClass]="{'valid': newPassword.length >= 6}">
          <span class="rule-icon">{{ newPassword.length >= 6 ? '✅' : '❌' }}</span>
          Mínimo 6 caracteres
        </div>
        <div class="rule" [ngClass]="{'valid': hasUpperCase()}">
          <span class="rule-icon">{{ hasUpperCase() ? '✅' : '❌' }}</span>
          Al menos una mayúscula
        </div>
        <div class="rule" [ngClass]="{'valid': hasNumber()}">
          <span class="rule-icon">{{ hasNumber() ? '✅' : '❌' }}</span>
          Al menos un número
        </div>
        <div class="rule" [ngClass]="{'valid': passwordsMatch()}">
          <span class="rule-icon">{{ passwordsMatch() ? '✅' : '❌' }}</span>
          Las contraseñas coinciden
        </div>
      </div>
      
      <!-- Mostrar mensaje de error si existe -->
      <div *ngIf="errorMessage" class="error-message">
        {{ errorMessage }}
      </div>
      
      <!-- Mostrar mensaje de éxito si existe -->
      <div *ngIf="successMessage" class="success-message">
        {{ successMessage }}
      </div>
      
      <!-- Botón cambiar contraseña -->
      <button 
        type="submit"
        [disabled]="isLoading || !isFormValid()"
        class="login-button"
      >
        <span *ngIf="!isLoading">🔄 Cambiar contraseña</span>
        <span *ngIf="isLoading">Cambiando... ⏳</span>
      </button>
      
      <!-- Botón volver -->
      <button 
        type="button"
        (click)="volver()"
        class="back-button"
        [disabled]="isLoading"
      >
        ← Volver
      </button>
    </form>
    
    <p class="help-text">
      Usa una contraseña fuerte que incluya mayúsculas, números y sea fácil de recordar para ti.
    </p>
  </div>
</div>
