<div class="game-container">
  
  <!-- ============================================ -->
  <!-- PANTALLA DE INSTRUCCIONES -->
  <!-- ============================================ -->
  <div *ngIf="vistaActual === 'instrucciones'" class="instructions-screen">
    <!-- Header del juego -->
    <div class="game-header">
      <div class="header-content">
        <button class="btn-back" (click)="volverAlMenu()">
          <span class="back-icon">‚Üê</span>
          <span class="btn-text">Volver</span>
        </button>
        <div class="game-info">
          <h1>Sonidos Divertidos</h1>
          <p>Imita los sonidos que escuchas</p>
        </div>
        <div class="game-stats"></div>
      </div>
    </div>

    <div class="instructions-card">
      <div class="instructions-header">
        <h2>Sonidos Divertidos</h2>
        <span class="difficulty-badge">F√°cil</span>
      </div>

      <div class="instructions-content">
        <div class="step">
          <div class="step-number">1</div>
          <div class="step-text">
            <strong>Observa la imagen</strong>
            <p>Ver√°s un animal, objeto o cosa que hace un sonido especial</p>
          </div>
        </div>

        <div class="step">
          <div class="step-number">2</div>
          <div class="step-text">
            <strong>Escucha el sonido</strong>
            <p>Presiona el bot√≥n amarillo para escuchar c√≥mo suena</p>
          </div>
        </div>

        <div class="step">
          <div class="step-number">3</div>
          <div class="step-text">
            <strong>Haz el sonido</strong>
            <p>Presiona el bot√≥n rojo y di el sonido en voz alta</p>
          </div>
        </div>

        <div class="step">
          <div class="step-number">4</div>
          <div class="step-text">
            <strong>Completa todos los sonidos</strong>
            <p>Practica con todos los animales y objetos divertidos</p>
          </div>
        </div>
      </div>

      <div class="tips-section">
        <h3>Consejos:</h3>
        <ul>
          <li>Habla claro y fuerte cuando hagas el sonido</li>
          <li>Escucha bien antes de intentar imitar</li>
          <li>Si no te sale, puedes intentar varias veces</li>
          <li>Divi√©rtete haciendo los sonidos</li>
        </ul>
      </div>

      <button class="btn-start" (click)="comenzarJuego()">
        Comenzar a Jugar
      </button>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- PANTALLA DE JUEGO -->
  <!-- ============================================ -->
  <div *ngIf="vistaActual === 'jugando'">
    
    <!-- Header del juego -->
    <div class="game-header">
      <div class="header-content">
        <button class="btn-back" (click)="volverAlMenu()">
          <span class="back-icon">‚Üê</span>
          <span class="btn-text">Volver</span>
        </button>
        <div class="game-info">
          <h1>Sonidos Divertidos</h1>
        </div>
        <div class="game-stats">
          <div class="stat">
            <span class="stat-label">Progreso</span>
            <span class="stat-value">{{ indiceActual + 1 }}/{{ sonidos.length }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Barra de progreso -->
    <div class="progress-bar-container" *ngIf="!juegoCompletado">
      <div class="progress-bar" [style.width.%]="progreso"></div>
    </div>

    <!-- Contenido principal del juego -->
    <div class="game-main" *ngIf="sonidoActual && !juegoCompletado">
      
      <!-- Tarjeta del sonido actual -->
      <div class="sound-card">
        <div class="sound-emoji">
          {{ sonidoActual.imagen }}
        </div>
        <h2 class="sound-name">{{ sonidoActual.nombre }}</h2>
        <div class="sound-text">{{ sonidoActual.onomatopeya }}</div>
        
        <!-- Botones de acci√≥n -->
        <div class="action-buttons">
          <button class="btn-listen" (click)="reproducirSonido()" [disabled]="escuchandoAhora">
            <span class="btn-icon">üîä</span>
            <span class="btn-text">Escuchar</span>
          </button>
          
          <button 
            class="btn-speak" 
            [class.recording]="escuchandoAhora"
            (click)="iniciarDeteccion()" 
            [disabled]="!reconocimientoDisponible">
            <span class="btn-icon">üé§</span>
            <span class="btn-text">{{ escuchandoAhora ? 'Escuchando...' : 'Hablar' }}</span>
          </button>
        </div>

        <!-- Indicador de grabaci√≥n -->
        <div class="recording-indicator" *ngIf="escuchandoAhora">
          <div class="pulse-circle"></div>
          <span class="recording-text">Di el sonido ahora...</span>
        </div>

        <!-- Mostrar lo que escuch√≥ -->
        <div class="transcription-display" *ngIf="transcripcion && !mostrarFeedback">
          <span class="transcription-label">Escuch√©:</span>
          <span class="transcription-text">{{ transcripcion }}</span>
        </div>
      </div>

      <!-- Feedback visual -->
      <div class="feedback-container" *ngIf="mostrarFeedback">
        <div class="feedback-message" [class.correcto]="feedbackTipo === 'correcto'" [class.incorrecto]="feedbackTipo === 'incorrecto'">
          <span class="feedback-icon">{{ feedbackTipo === 'correcto' ? '‚úì' : '‚úó' }}</span>
          <span class="feedback-texto">{{ feedbackMensaje }}</span>
        </div>
      </div>

      <!-- Informaci√≥n de intentos -->
      <div class="attempts-info" *ngIf="intentoActual > 0 && !mostrarFeedback">
        <p>Intento {{ intentoActual }}/{{ maxIntentos }}</p>
      </div>

    </div>

    <!-- Celebraci√≥n mejorada entre sonidos -->
    <div class="celebracion-overlay" *ngIf="mostrarCelebracion && !juegoCompletado">
      <div class="celebracion-card">
        <div class="success-icon">
          <svg viewBox="0 0 52 52" class="checkmark">
            <circle class="checkmark-circle" cx="26" cy="26" r="25" fill="none"/>
            <path class="checkmark-check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/>
          </svg>
        </div>
        <h2 class="celebracion-title">¬°Excelente!</h2>
        <p class="celebracion-message">¬°Lo hiciste perfecto!</p>
        <div class="progress-dots">
          <span class="dot active"></span>
          <span class="dot active"></span>
          <span class="dot active"></span>
        </div>
      </div>
    </div>

    <!-- Pantalla de juego completado -->
    <div class="game-completed" *ngIf="juegoCompletado">
      <div class="completion-card">
        <div class="trophy-icon">
          <svg viewBox="0 0 100 100" class="trophy">
            <path d="M30 20 L30 35 Q30 45 40 45 L40 60 L35 60 L35 70 L65 70 L65 60 L60 60 L60 45 Q70 45 70 35 L70 20 Z" 
                  fill="#ffd700" stroke="#f5a623" stroke-width="2"/>
            <circle cx="50" cy="30" r="8" fill="#f5a623"/>
            <rect x="25" y="70" width="50" height="8" rx="2" fill="#8b4513"/>
          </svg>
        </div>
        <h2>¬°Felicitaciones!</h2>
        <p class="completion-message">
          ¬°Completaste todos los sonidos!
        </p>
        <p class="completion-submessage">
          ¬°Eres incre√≠ble imitando sonidos!
        </p>
        <div class="completion-buttons">
          <button class="btn-reiniciar" (click)="reiniciarJuego()">
            Jugar de nuevo
          </button>
          <button class="btn-menu" (click)="volverAlMenu()">
            Men√∫ principal
          </button>
        </div>
      </div>
    </div>

  </div>
</div>