<div class="game-container">
  <!-- Header compacto -->
  <div class="game-header">
    <button class="btn-back" (click)="volverAlMenu()">
      <span class="icon">ğŸ </span>
      <span class="btn-text">Volver</span>
    </button>
    <h1 class="game-title">
      <span class="title-emoji"></span>
      <span class="title-text">Sonidos OnomatopÃ©yicos </span>
      <span class="title-emoji"></span>
    </h1>
  </div>

  <!-- Barra de progreso -->
  <div class="progress-bar-container">
    <div class="progress-bar" [style.width.%]="progreso"></div>
  </div>

  <!-- Contenido principal -->
  <div class="main-content" *ngIf="!juegoCompletado && !mostrarCelebracion && sonidoActual">
    
    <!-- Tarjeta del animal con emoji gigante -->
    <div class="animal-display-card">
      <div class="animal-emoji-huge">{{ sonidoActual.imagen }}</div>
      <h2 class="animal-name-big">{{ sonidoActual.nombre }}</h2>
      
      <div class="sound-bubble">
        <span class="sound-icon">ğŸ’¬</span>
        <p class="onomatopeya-text">{{ sonidoActual.onomatopeya }}</p>
      </div>

      <div class="instruction-compact">
        <span class="instruction-icon">ğŸ‘„</span>
        <p class="instruction-text">Â¡Haz el sonido del {{ sonidoActual.nombre.toLowerCase() }}!</p>
      </div>
    </div>

    <!-- TranscripciÃ³n (si existe) -->
    <div class="transcription-card" *ngIf="transcripcion && escuchandoAhora">
      <span class="transcription-icon">ğŸ‘‚</span>
      <div class="transcription-content">
        <p class="transcription-label">EscuchÃ©:</p>
        <p class="transcription-text">"{{ transcripcion }}"</p>
      </div>
    </div>

    <!-- Feedback -->
    <div class="feedback-card" *ngIf="mostrarFeedback" [ngClass]="feedbackTipo">
      <span class="feedback-icon" *ngIf="feedbackTipo === 'correcto'">âœ…</span>
      <span class="feedback-icon" *ngIf="feedbackTipo === 'incorrecto'">ğŸ’­</span>
      <p class="feedback-message">{{ feedbackMensaje }}</p>
    </div>

    <!-- Botones de acciÃ³n -->
    <div class="action-buttons">
      <button class="btn-action btn-listen" (click)="reproducirSonido()" [disabled]="escuchandoAhora">
        <span class="btn-icon">ğŸ”Š</span>
        <span class="btn-label">Escuchar</span>
      </button>
      
      <button 
        class="btn-action btn-record" 
        (click)="iniciarDeteccion()" 
        [disabled]="escuchandoAhora || !reconocimientoDisponible"
        [ngClass]="{'recording': escuchandoAhora}">
        <span class="btn-icon">ğŸ¤</span>
        <span class="btn-label" *ngIf="!escuchandoAhora">Grabar</span>
        <span class="btn-label" *ngIf="escuchandoAhora">Escuchando...</span>
        <span class="recording-pulse" *ngIf="escuchandoAhora"></span>
      </button>
    </div>

    <!-- BotÃ³n saltar (solo despuÃ©s de 2 intentos) -->
    <button class="btn-skip" (click)="saltarSonido()" *ngIf="intentoActual >= 2">
      <span class="btn-icon">â­ï¸</span>
      <span class="btn-label">Saltar</span>
    </button>

    <!-- Warning reconocimiento -->
    <div class="warning-banner" *ngIf="!reconocimientoDisponible">
      <span class="warning-icon">âš ï¸</span>
      <p>Reconocimiento de voz no disponible. Usa Chrome o Edge.</p>
    </div>

    <!-- Indicador de intentos -->
    <div class="attempts-indicator" *ngIf="intentoActual > 0 && intentoActual < maxIntentos">
      <div class="attempts-dots">
        <span class="dot" [class.active]="i < intentoActual" *ngFor="let i of [0, 1, 2]"></span>
      </div>
      <p class="attempts-text">Intento {{ intentoActual }} de {{ maxIntentos }}</p>
    </div>
  </div>

  <!-- CelebraciÃ³n -->
  <div class="celebration-overlay" *ngIf="mostrarCelebracion && !juegoCompletado">
    <div class="celebration-content">
      <div class="celebration-emoji">ğŸ‰</div>
      <h2 class="celebration-title">Â¡Excelente!</h2>
      <p class="celebration-message">Â¡Lo hiciste perfecto!</p>
      <div class="celebration-stars">
        <span class="star">â­</span>
        <span class="star">â­</span>
        <span class="star">â­</span>
      </div>
    </div>
  </div>

  <!-- Pantalla completada -->
  <div class="game-completed" *ngIf="juegoCompletado">
    <div class="completion-card">
      <div class="completion-fireworks">
        <span class="firework">ğŸ†</span>
        <span class="firework">ğŸ‡</span>
        <span class="firework">âœ¨</span>
      </div>
      
      <div class="completion-trophy">ğŸ†</div>
      
      <h2 class="completion-title">Â¡Felicitaciones!</h2>
      
      <p class="completion-message">
        Â¡Completaste todos los sonidos!
      </p>
      
      <p class="completion-submessage">
        Â¡Hiciste un trabajo increÃ­ble! ğŸŒŸ
      </p>
      
      <div class="completion-stats">
        <div class="stat-item">
          <span class="stat-icon">ğŸµ</span>
          <span class="stat-value">{{ sonidos.length }}</span>
          <span class="stat-label">Sonidos</span>
        </div>
        <div class="stat-item">
          <span class="stat-icon">â­</span>
          <span class="stat-value">100%</span>
          <span class="stat-label">Completado</span>
        </div>
      </div>
      
      <div class="completion-buttons">
        <button class="btn-restart" (click)="reiniciarJuego()">
          <span class="icon">ğŸ”„</span>
          <span class="btn-text">Jugar de nuevo</span>
        </button>
        <button class="btn-home" (click)="volverAlMenu()">
          <span class="icon">ğŸ </span>
          <span class="btn-text">MenÃº principal</span>
        </button>
      </div>
    </div>
  </div>
</div>